---
# file defaults/main.yml

burpui_pip_burpui: "burp-ui"
burpui_version: 0.5.1
python_pip_executable: "pip2" # options pip3 / pip2

burpui_pip_packages:
  - { name: "{{ burpui_pip_burpui }}", version: "{{ burpui_version }}" }
  - { name: "{{ burpui_pip_burpui }}[sql]", version: "{{ burpui_version }}" }
  - { name: "{{ burpui_pip_burpui }}[ldap_authentication]", version: "{{ burpui_version }}" }
  - { name: "{{ burpui_pip_burpui }}[gunicorn]", version: "{{ burpui_version }}" }
  - { name: "{{ burpui_pip_burpui }}[gunicorn-extra]", version: "{{ burpui_version }}" }
  - { name: "{{ burpui_pip_burpui }}[celery]", version: "{{ burpui_version }}" }
  
burpui_pip_present:
  - "redis"
  - "Flask-Session"
  - "Flask-Migrate"
  - "celery>=4.0.2"
  - "pip>=9"
  - "cffi>=1.7"
  - "gevent>=1.2"
  - "ujson>=1.35"
  - "urllib3>=1.19" # required to avoid issues with get_url module
  # - "ndg-httpsclient>=0.4.2" # required to avoid issues with get_url module
  - "pyasn1"
  - "six>=1.10.0"  # try to fix error in dependencies with requests[security]
  - "requests[security]>=2.12"  # required to avoid issues with get_url module
  - "flask-limiter"

  
burpui_nginx_port: "8080"

burpui_standalone: true

#[Global]
burpui_global_port: "5000"
burpui_global_bind: "127.0.0.1"
burpui_global_ssl: "false"
burpui_global_sslcert: "/etc/burp/ssl_cert-server.pem"
burpui_global_sslkey: "/etc/burp/ssl_cert-server.key"
burpui_global_version: "2"
burpui_global_auth: "basic"
burpui_global_acl: "basic"
burpui_global_prefix: "none"
#[UI]
burpui_ui_refresh: "180"
burpui_ui_liverefresh: "60"
#[Production]
burpui_production_storage: "redis"
burpui_production_session: "redis://localhost:6379/0"
burpui_production_cache: "redis"
burpui_production_redis: "localhost:6379"
burpui_production_celery: "true"
burpui_production_database: "sqlite:////var/spool/burpui/celery.db"
#[Security]
burpui_security_includes: "/etc/burp"
burpui_security_enforce: "false"
burpui_security_revoke: "true"
burpui_security_cookietime: "14"
burpui_security_scookie: "true"
burpui_security_appsecret: "random"
#[Experimental]
burpui_experimental_zip64: "false"
burpui_experimental_noserverrestore: "false"
#[Backend]
burpui_backend_burpbin: "/usr/sbin/burp"
burpui_backend_stripbin: "/usr/bin/vss_strip"
burpui_backend_bconfcli: "/etc/burp/burp.conf"
burpui_backend_bconfsrv: "/etc/burp/burp-server.conf"
burpui_backend_tmpdir: "/tmp"
burpui_backend_timeout: "60"
#[LDAP]
burpui_ldap_enabled: false
burpui_ldap_priority: "1"
burpui_ldap_host: "127.0.0.1"
burpui_ldap_port: "389"
burpui_ldap_encryption: "ssl"
burpui_ldap_validate: "none"
burpui_ldap_version: "TLSv1"
burpui_ldap_cafile: "none"
burpui_ldap_searchattr: "uid"
burpui_ldap_base: '"ou=users,dc=example,dc=com"'
burpui_ldap_binddn: '"cn=admin,dc=example,dc=com"'
burpui_ldap_bindpw: "Sup3rS3cr3tPa$$w0rd"

#[BASIC]
burpui_basic_enabled: false
burpui_basic_priority: "2"
# Enable mixed to allow plain passwords https://git.ziirish.me/ziirish/burp-ui/issues/177#note_1794
burpui_basic_mixed: "true"
burpui_basic_users:
  - { name: "admin", password: "admin" }

#[LOCAL]
burpui_local_enabled: false
burpui_local_priority: "3"
burpui_local_users: "user1,user2"

#[BASIC:ACL]
# http://burp-ui.readthedocs.io/en/latest/usage.html#basic-acl
burpui_basic_acl_enabled: false
burpui_basic_acl_admins: "user1,user2"
burpui_basic_acl_users: false
#burpui_basic_acl_users:
#  - { name: "user3", value: '["client4", "client5"]' }
#  - { name: "user4", value: '{"agent2": ["client8"], "agent1": ["client6", "client7"]}' }

# bui-agent
# change burpui_standalone: false
# To use multiple agents:
burpui_agents:
  - { name: "localhost", address: "127.0.0.1", port: "5001", password: "password", ssl: "false" }

# Bui Celery
burpui_sv_priority: "20"
burpui_sv_directory: "/tmp"
burpui_sv_environment: "C_FORCE_ROOT=true"
burpui_sv_command: "bui-celery -c /etc/burp/burpui.cfg -- --beat"
burpui_sv_user: "root"
burpui_sv_autostart: "true"
burpui_sv_autorestart: "true"
burpui_sv_stdout_logfile: "/var/log/supervisor/%(program_name)s.log"
burpui_sv_stderr_logfile: "/var/log/supervisor/%(program_name)s.log"

# In development options / could not make effect on all files yet

burpui_user: 'root'  # for now only root will work until we handle the creation of the user and set permissions correctly
burpui_group: 'root'
# gunicorn_systemd_service enables gunicorn.yml to manually setup systemd service instead of using Debian based package
# It is set True always for RedHat based and Ubuntu equal or major to 16.04
gunicorn_systemd_service: False
